version: "1.0"

replication_group: "aaron_test_group"

# Source Databricks Connect configuration
source_databricks_connect_config:
  name: "azure"
  type: "azure"
  region: "eastus"
  host: "https://source-databricks-instance"
  token:
    secret_scope: "my_secret_scope"
    secret_key: "my_secret_key"

# Target Databricks Connect configuration
target_databricks_connect_config:
  name: "aws"
  type: "aws"
  region: "us-west-2"
  host: "https://target-databricks-instance"
  token:
    secret_scope: "my_secret_scope"
    secret_key: "my_secret_key"

delta_share_config:
  recipient_id: "aws_recipient"
  provider_name: "azure"

audit_config:
  audit_table: "aaron.audit.audit_logging"

# replicator configuration. streaming table can not be backed up and replicate with other objects together. validate the configuration carefully.
# backup_catalog only provided for streaming_table replication. validate the configuration carefully.
target_catalogs:
  - catalog_name: "aaron"
    table_types: ["streaming_table"]
    schema_filter_expression: "databaseName like 'bonze_%'"
    backup_config:
      enabled: true
      source_catalog: "aaron"       
      backup_catalog: "aaron_dr"
      delta_share_config:
        create_share: true
        share_name: "aaron_azure"
        backup_share_name: "aaron_dr_azure"

    replication_config:
      enabled: true
      source_catalog: "aaron_dr_azure_shared"
      intermediate_catalog: "aaron_dr"
      enforce_schema: true
      delta_share_config:
        create_catalog: false
        share_name: "aaron_dr_azure"        
        shared_catalog_name: "aaron_dr_azure_shared"
    reconciliation_config:
      enabled: true
      delta_share_config:
        create_catalog: false
        share_name: "aaron_azure"        
        shared_catalog_name: "aaron_azure_shared"
      source_catalog: "aaron_azure_shared"
      recon_outputs_catalog: "recon_results"
      schema_check: true
      row_count_check: true
      missing_data_check: true
    target_schemas:
      - schema_name: "bonze_1"
      - schema_name: "bonze_2"
        tables:
          - table_name: "product_metrics"
          - table_name: "sales_data"
      - schema_name: "bonze_3"
        exclude_tables:
          - table_name: "temp_table"

# Concurrency settings
concurrency:
  max_workers: 4
  timeout_seconds: 3600

# Retry settings
retry:
  max_attempts: 3
  retry_delay_seconds: 5